# D03: AGENTS.md Block Content Specification

**Status**: ✅ Confirmed  
**Decision Date**: 2026-02-08  
**Source**: Claude Code Asset Management Discussion

## Decision

Define the structure and content of the `<leslie_system_guide>` block injected into AGENTS.md.

## Content Sections

### 1. Overview
Brief introduction to Leslie's role and core concepts (Objective, Thread, Asset).

### 2. Context Format
Explanation of `<thread_context>` XML structure that Agents receive in User Messages.

**Key Elements**:
- `thread`: Current Thread ID
- `objective`: Parent Objective ID
- `<asset>`: Current Thread's assets (read-write)
- `<ref>`: Referenced Thread's assets (read-only)

### 3. Asset Types

Each asset documented with five aspects:

| Aspect | Description |
|--------|-------------|
| **What** | Brief description of the asset |
| **Location** | File path pattern |
| **When** | When to create/update |
| **How to use** | Usage instructions |
| **Generation** | Who creates it and how |

**Asset Types Covered**:
- **plan** (Required): Task breakdown and execution plan
- **progress** (Required): Execution status tracking
- **design** (Optional): Technical/product design documents
- **learnings** (Optional): Research findings and analysis
- **transcript** (Read-Only): Execution trace, auto-generated by CLI

### 4. Agent Responsibilities

Clear checklist of Agent duties:
1. Parse `<thread_context>` to understand scope
2. Create plan if none exists
3. Update progress after each step
4. Generate design/learnings as needed
5. Stay in scope (only modify own Thread's assets)

### 5. Thread Operations

Document CLI commands for Thread lifecycle management:
- `leslie spawn --intent "..."` - Create new Thread
- `leslie spawn --ref <thread-id>` - Create with reference
- `leslie lifecycle <thread-id> done` - Mark complete
- `leslie lifecycle <thread-id> blocked` - Mark blocked

### 6. Cross-Thread Reference

Rules for working with referenced assets:
- ✓ Read referenced assets as needed
- ✗ Do NOT modify other Threads' assets
- ✓ If changes needed, spawn new Thread or coordinate

## Content Maintenance

### Version Bump Triggers

| Change | Version Bump |
|--------|--------------|
| Add new asset type | MINOR |
| Change asset structure | MAJOR |
| Fix typos or wording | PATCH |
| Add CLI command | MINOR |
| Change core concepts | MAJOR |

### Template Location

Canonical block content template: `packages/cli/src/templates/leslie-system-guide.md`

## Design Principles

1. **Comprehensive**: Cover all essential information Agents need
2. **Concise**: Keep under ~800 words, ~3 min reading time
3. **Actionable**: Use concrete examples, not abstract descriptions
4. **Consistent**: Follow same structure across all sections

## Related Decisions

| Decision | Relationship |
|----------|-------------|
| D01 Asset Management Architecture | D03 documents asset types defined in D01 |
| D02 AGENTS.md Initialization | D03 specifies content injected by D02 |
| D04-D07 Asset Formats | D03 references detailed formats |

## Related Templates

- [Leslie System Guide Template](../templates/leslie-system-guide.md) - Complete block content
- [Thread Context Format](../templates/thread-context-format.md) - XML structure reference

---
← [Back to outline](../outline.md)
